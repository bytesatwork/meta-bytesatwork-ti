From 24374e736e3e941a84961c72a83bb1d4b0d4627b Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Stephan=20D=C3=BCnner?= <stephan.duenner@bytesatwork.ch>
Date: Fri, 2 Jun 2023 13:06:29 +0200
Subject: [PATCH] arm64: ti: k3-am625-bytedevkit: Add display support
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Enable Youritech ET050WV05 5" WVGA (800x480) LVDS TFT LCD panel.

Signed-off-by: Stephan DÃ¼nner <stephan.duenner@bytesatwork.ch>
---
 .../arm64/boot/dts/ti/k3-am625-bytedevkit.dts | 58 +++++++++++++++++++
 1 file changed, 58 insertions(+)

diff --git a/arch/arm64/boot/dts/ti/k3-am625-bytedevkit.dts b/arch/arm64/boot/dts/ti/k3-am625-bytedevkit.dts
index dba17befca1d..242f22a098bc 100644
--- a/arch/arm64/boot/dts/ti/k3-am625-bytedevkit.dts
+++ b/arch/arm64/boot/dts/ti/k3-am625-bytedevkit.dts
@@ -34,6 +34,25 @@ extcon_usb1: extcon-usb1 {
 		pinctrl-names = "default";
 		pinctrl-0 = <&main_usb1_gpio_id_pins_default>;
 	};
+
+	display0: display {
+		compatible = "youritech,et050WV05";
+		backlight = <&lcd_bl>;
+		enable-gpios = <&main_gpio0 77 GPIO_ACTIVE_HIGH>, <&main_gpio0 78 GPIO_ACTIVE_HIGH>;
+		status = "okay";
+
+		port {
+			lcd_in0: endpoint {
+				remote-endpoint = <&oldi_out0>;
+			};
+		};
+	};
+
+	lcd_bl: backlight {
+		compatible = "gpio-backlight";
+		gpios = <&main_gpio1 13 GPIO_ACTIVE_HIGH>;
+		default-on;
+	};
 };
 
 &main_pmx0 {
@@ -111,6 +130,26 @@ main_usb1_gpio_id_pins_default: main-usb1-gpio-id-pins-default {
 			AM62X_IOPAD(0x0198, PIN_INPUT, 0) /* (A19) MCASP0_AXR2 */
 		>;
 	};
+
+	oldi0_pins_default: oldi0-pins-default {
+		pinctrl-single,pins = <
+			AM62X_IOPAD(0x260, PIN_OUTPUT, 0) /* (AA5) OLDI0_A0N */
+			AM62X_IOPAD(0x25c, PIN_OUTPUT, 0) /* (Y6) OLDI0_A0P */
+			AM62X_IOPAD(0x268, PIN_OUTPUT, 0) /* (AD3) OLDI0_A1N */
+			AM62X_IOPAD(0x264, PIN_OUTPUT, 0) /* (AB4) OLDI0_A1P */
+			AM62X_IOPAD(0x270, PIN_OUTPUT, 0) /* (Y8) OLDI0_A2N */
+			AM62X_IOPAD(0x26c, PIN_OUTPUT, 0) /* (AA8) OLDI0_A2P */
+			AM62X_IOPAD(0x278, PIN_OUTPUT, 0) /* (AB6) OLDI0_A3N */
+			AM62X_IOPAD(0x274, PIN_OUTPUT, 0) /* (AA7) OLDI0_A3P */
+			AM62X_IOPAD(0x2a0, PIN_OUTPUT, 0) /* (AD4) OLDI0_CLK0N */
+			AM62X_IOPAD(0x29c, PIN_OUTPUT, 0) /* (AE3) OLDI0_CLK0P */
+			AM62X_IOPAD(0x13c, PIN_OUTPUT, 7) /* (AA15) GPIO0_77 Display enable */
+			AM62X_IOPAD(0x140, PIN_OUTPUT, 7) /* (AA15) GPIO0_78 Display reset */
+			AM62X_IOPAD(0x1ac, PIN_OUTPUT, 7) /* (B18) GPIO1_13 Display1 pwm */
+			AM62X_IOPAD(0x19c, PIN_OUTPUT, 7) /* (B18) GPIO1_9 Display2 pwm */
+			AM62X_IOPAD(0x174, PIN_OUTPUT, 7) /* (AD21) GPIO0_91 Display2 enable */
+		>;
+	};
 };
 
 &main_uart0 {
@@ -171,3 +210,22 @@ cpsw3g_phy1: ethernet-phy@3 {
 		reg = <3>;
 	};
 };
+
+&dss {
+	pinctrl-names = "default";
+	pinctrl-0 = <&oldi0_pins_default>;
+};
+
+&dss_ports {
+	#address-cells = <1>;
+	#size-cells = <0>;
+	status = "okay";
+
+	port@0 {
+		reg = <0>;
+
+		oldi_out0: endpoint {
+			remote-endpoint = <&lcd_in0>;
+		};
+	};
+};
-- 
2.39.2

